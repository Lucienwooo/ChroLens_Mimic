# 螢幕截圖驗證碼識別 - 使用說明

## 📸 功能說明

全新的**螢幕截圖識別**功能讓你可以直接框選螢幕上任何區域的驗證碼進行識別,無需先儲存圖片。

## 🎯 使用方法

### 方法 1: 識別選定圖片
1. 在圖片列表中選擇一張圖片
2. 點擊「🔍 識別選定圖片」按鈕
3. 等待識別完成,結果會顯示在上方文字框
4. 點擊「📋」按鈕可複製結果

### 方法 2: 螢幕截圖識別 ⭐ 新功能
1. 點擊「📸 截圖識別」按鈕
2. 視窗會自動最小化,螢幕變成半透明黑色
3. 用滑鼠**拖曳框選**驗證碼區域
4. 放開滑鼠後自動識別
5. 結果會顯示在文字框中

**操作提示:**
- 框選時會顯示紅色矩形
- 按 `ESC` 可取消截圖
- 框選區域至少要 10x10 像素

## 🔧 解決 DLL 缺失問題

程式已自動修復 `zlib1.dll` 缺失的問題,方法如下:

### 自動修復機制
程式會自動將 Tesseract 安裝目錄加入系統 PATH,這樣所有 DLL 檔案都能被正確載入。

### 手動檢查 (如果仍有問題)
1. 確認 Tesseract 已安裝在:
   - `C:\Program Files\Tesseract-OCR\`

2. 檢查 DLL 檔案是否存在:
   ```powershell
   Test-Path "C:\Program Files\Tesseract-OCR\zlib1.dll"
   Test-Path "C:\Program Files\Tesseract-OCR\tesseract.exe"
   ```

3. 如果 DLL 存在但仍報錯,請重新安裝 Tesseract:
   ```powershell
   winget uninstall --id=UB-Mannheim.TesseractOCR
   winget install --id=UB-Mannheim.TesseractOCR
   ```

## 💡 識別效果最佳化

### 提高識別準確度
1. **框選要精準**: 只框選驗證碼本身,不要包含太多背景
2. **字體要清晰**: 避免模糊或扭曲嚴重的驗證碼
3. **對比度要高**: 黑底白字或白底黑字效果最好
4. **尺寸適中**: 驗證碼不要太小 (建議至少 50x20 像素)

### 識別範圍
- ✅ **英文字母**: A-Z, a-z
- ✅ **數字**: 0-9
- ❌ **特殊符號**: 不識別
- ❌ **中文**: 不識別 (可修改配置支援)

## 🐛 常見問題

### Q1: 點擊「截圖識別」後沒反應
**A:** 檢查 `screen_capture.py` 是否在同一目錄下

### Q2: 識別結果不準確
**A:** 嘗試:
1. 重新框選,確保只包含驗證碼
2. 檢查驗證碼是否清晰
3. 調整螢幕亮度/對比度

### Q3: 仍然出現 DLL 缺失錯誤
**A:** 
1. 關閉程式
2. 重新啟動程式 (PATH 變更會生效)
3. 如果仍有問題,重新安裝 Tesseract

### Q4: 框選區域後沒有識別
**A:** 
1. 確保框選區域至少 10x10 像素
2. 檢查是否有錯誤訊息彈出
3. 查看狀態列的訊息

## 📝 技術細節

### 圖片前處理流程
1. **灰階轉換**: 將彩色圖片轉為灰階
2. **自適應二值化**: 增強字符與背景對比
3. **降噪處理**: 移除雜訊
4. **放大 2 倍**: 提高識別準確度
5. **OCR 識別**: 使用 Tesseract 引擎

### 修復的問題
- ✅ 修復 `zlib1.dll` 缺失錯誤 (自動加入 PATH)
- ✅ 支援中文路徑的圖片檔案
- ✅ 支援 PIL Image 和檔案路徑兩種輸入
- ✅ 線程安全的 UI 更新

### 新增的檔案
- `screen_capture.py`: 螢幕截圖選擇器
- `SCREEN_CAPTURE_GUIDE.md`: 本說明文件

## 🚀 使用範例

### 範例 1: 遊戲登入驗證碼
1. 遊戲顯示登入驗證碼
2. 開啟圖片管理器
3. 點擊「📸 截圖識別」
4. 框選驗證碼區域
5. 複製識別結果到遊戲

### 範例 2: 網頁驗證碼
1. 網頁顯示驗證碼
2. 使用截圖識別功能
3. 框選驗證碼
4. 自動識別並可複製

## 🎨 UI 更新

### 按鈕配置
- **🔍 識別選定圖片** (綠色): 識別圖片列表中選定的圖片
- **📸 截圖識別** (橙色): 螢幕截圖後識別

### 狀態顯示
- 🔍 正在識別驗證碼... (橙色背景)
- ✅ 識別成功: XXXXX (綠色背景)
- ⚠️ 未能識別驗證碼 (橙色背景)
- ❌ 識別失敗 (紅色背景)

## 📌 注意事項

1. **隱私**: 截圖功能會捕獲螢幕內容,請注意不要洩露敏感資訊
2. **效能**: 識別過程需要 1-3 秒,請耐心等待
3. **準確度**: OCR 不是 100% 準確,複雜驗證碼可能識別錯誤
4. **相容性**: 需要 Windows 7+ 系統

## 🔄 更新記錄

### v1.3 (2025-11-18)
- ✅ 新增螢幕截圖識別功能
- ✅ 修復 zlib1.dll 缺失問題
- ✅ 改進圖片載入邏輯 (支援 PIL Image)
- ✅ 優化 UI 佈局 (兩個識別按鈕並排)

### v1.2
- ✅ 加入驗證碼識別功能
- ✅ 支援自動 Tesseract 路徑偵測

### v1.1
- ✅ 基礎圖片管理功能
