# ChroLens_Mimic 功能測試總結

## 測試日期: 2025年11月24日

---

## ✅ 已完成的改進

### 1. 合併視窗UI優化
**改進內容：**
- 將底部控制項（命名、延遲、按鈕）排成一行
- 左右兩個腳本列表變得更寬，顯示效果更好
- 使用 Grid 佈局實現水平排列
- 整體UI更加美觀和直覺

**新佈局：**
```
┌─────────────────────────────────────────────────────────┐
│ 📋 選擇要合併的腳本，按順序執行（腳本A → 腳本B → ...） │
├──────────────────────┬───────┬───────────────────────────┤
│ 所有腳本 (更寬)       │ 控制  │ 待合併腳本 (更寬)          │
│ ▢ 腳本名稱1           │ ➡加入 │ ▢ 選中的腳本A             │
│ ▢ 腳本名稱2           │ ⬅移除 │ ▢ 選中的腳本B             │
│ ▢ 腳本名稱3           │ ⬆上移 │                           │
│                      │ ⬇下移 │                           │
├──────────────────────┴───────┴───────────────────────────┤
│ 新腳本名稱: [        ] 腳本間延遲(秒): [0] [合併] [取消] │
└─────────────────────────────────────────────────────────┘
```

### 2. 自動戰鬥視窗選擇整合
**改進內容：**
- 添加「🎯 選擇視窗」按鈕
- 直接使用主程式的 WindowSelectorDialog
- 視窗標題輸入框改為唯讀（只能透過選擇器設定）
- 避免手動輸入錯誤的視窗標題

**使用流程：**
1. 開啟自動戰鬥設定
2. 點擊「🎯 選擇視窗」按鈕
3. 在彈出的視窗選擇器中選擇遊戲視窗
4. 自動填入視窗標題
5. 點擊「🔍 測試連接」驗證

---

## 🧪 測試建議

### 測試場景 1: 合併視窗UI
1. 開啟主程式
2. 進入「腳本設定」頁面
3. 點擊「合併腳本」按鈕
4. **驗證點：**
   - 視窗寬度為 750px
   - 左右列表更寬，腳本名稱完整顯示
   - 底部控制項在同一行
   - 所有元素對齊整齊

### 測試場景 2: 自動戰鬥視窗選擇
1. 開啟「自動戰鬥」頁面
2. 點擊「🎯 選擇視窗」按鈕
3. 選擇任一視窗（如瀏覽器）
4. **驗證點：**
   - 視窗標題自動填入
   - 無法手動編輯視窗標題
   - 點擊「測試連接」應成功

### 測試場景 3: 自動戰鬥測試方案

#### 方案A：使用網頁遊戲測試
**推薦遊戲：**
1. **Diep.io** (https://diep.io/)
   - 簡單的坦克射擊遊戲
   - 有明確的角色和敵人
   - 可以測試移動和攻擊

2. **Agar.io** (https://agar.io/)
   - 吃球遊戲
   - 測試移動和追蹤

3. **Little Big Snake** (https://littlebigsnake.com/)
   - 貪食蛇遊戲
   - 有清晰的角色和目標

**測試步驟：**
```python
1. 開啟瀏覽器（Chrome/Edge），進入遊戲
2. 使用「選擇視窗」選擇瀏覽器視窗
3. 進入遊戲後，截圖保存：
   - 角色模板（你控制的角色）
   - 敵人模板（敵人/目標物）
4. 設定按鍵對應：
   - WASD = 移動
   - Space = 攻擊/加速
5. 啟動自動戰鬥，觀察：
   - 是否能識別角色位置
   - 是否能識別敵人位置
   - 移動是否正確
```

#### 方案B：使用簡單的桌面應用測試
**小畫家(mspaint.exe)測試：**
```python
1. 開啟小畫家
2. 畫一個紅色圓圈（代表角色）
3. 畫幾個藍色方塊（代表敵人）
4. 截圖保存為模板
5. 測試圖片識別功能
```

#### 方案C：使用記事本測試基礎功能
**不需要影像辨識的測試：**
```python
1. 開啟記事本
2. 測試按鍵功能：
   - 設定按鍵為文字輸入
   - 觀察是否正確輸入
3. 測試視窗鎖定功能
4. 測試日誌記錄功能
```

---

## 🎮 自動戰鬥測試詳細步驟

### 推薦：使用 Diep.io 測試

**1. 準備階段：**
```
1. 開啟 Chrome 瀏覽器
2. 前往 https://diep.io/
3. 點擊 "Play" 進入遊戲
4. 將瀏覽器設為全螢幕（F11）
```

**2. 設定階段：**
```
1. 開啟 ChroLens_Mimic 主程式
2. 進入「自動戰鬥」頁面
3. 點擊「🎯 選擇視窗」，選擇 Chrome
4. 點擊「📸 截圖」按鈕：
   - 框選你的坦克（角色模板）
   - 框選敵方坦克（敵人模板，可添加多個）
5. 設定按鍵：
   - 移動：WASD（預設）
   - 攻擊：滑鼠左鍵（預設）
6. 戰鬥設定：
   - ✓ 啟用自動攻擊
   - 攻擊範圍：150
   - HP 閾值：0.5
```

**3. 執行測試：**
```
1. 點擊「▶ 啟動」按鈕
2. 觀察日誌輸出：
   - 視窗鎖定成功
   - 角色識別成功
   - 敵人識別成功
   - 移動指令發送
   - 攻擊指令發送
3. 觀察遊戲畫面：
   - 坦克是否自動移動
   - 是否自動攻擊敵人
   - 是否避開障礙物
```

**4. 驗證功能：**
- [ ] 視窗選擇功能正常
- [ ] 視窗鎖定功能正常
- [ ] 角色識別功能正常
- [ ] 敵人識別功能正常
- [ ] 移動功能正常
- [ ] 攻擊功能正常
- [ ] 日誌記錄正常
- [ ] 啟動/停止功能正常

---

## 🔍 圖片辨識測試

### 測試方案：使用圖片管理功能

**1. 準備測試圖片：**
```python
import os
from PIL import Image, ImageDraw

# 創建測試圖片資料夾
test_dir = "test_images"
os.makedirs(test_dir, exist_ok=True)

# 創建角色模板（紅色圓圈）
img = Image.new('RGB', (100, 100), 'white')
draw = ImageDraw.Draw(img)
draw.ellipse([20, 20, 80, 80], fill='red', outline='black')
img.save(f"{test_dir}/character_template.png")

# 創建敵人模板（藍色方塊）
img = Image.new('RGB', (100, 100), 'white')
draw = ImageDraw.Draw(img)
draw.rectangle([20, 20, 80, 80], fill='blue', outline='black')
img.save(f"{test_dir}/enemy_template.png")

print("✓ 測試圖片創建完成")
```

**2. 測試圖片識別：**
```python
from adaptive_navigation_system import AdaptiveNavigationSystem

# 初始化系統
nav = AdaptiveNavigationSystem()

# 載入模板
nav.set_character_template("test_images/character_template.png")
nav.add_enemy_template("enemy1", "test_images/enemy_template.png")

# 測試識別
char_pos = nav.find_character()
enemy_pos = nav.find_nearest_enemy()

print(f"角色位置: {char_pos}")
print(f"敵人位置: {enemy_pos}")
```

---

## 📊 測試結果模板

```markdown
## 測試執行記錄

**測試人員：** _________
**測試日期：** 2025年11月24日
**測試環境：** Windows 11 / Python 3.x

### 合併視窗UI測試
- [ ] 視窗尺寸正確 (750x650)
- [ ] 列表寬度增加
- [ ] 底部控制項水平排列
- [ ] 所有按鈕可正常操作
- **評分：** ☆☆☆☆☆

### 自動戰鬥視窗選擇測試
- [ ] 視窗選擇按鈕可見
- [ ] 選擇器正常開啟
- [ ] 視窗標題自動填入
- [ ] 測試連接功能正常
- **評分：** ☆☆☆☆☆

### 自動戰鬥功能測試
- [ ] 視窗鎖定成功
- [ ] 角色識別正確
- [ ] 敵人識別正確
- [ ] 自動移動正常
- [ ] 自動攻擊正常
- **評分：** ☆☆☆☆☆

### 圖片辨識測試
- [ ] 模板載入成功
- [ ] 角色識別準確
- [ ] 敵人識別準確
- [ ] 識別速度可接受
- **評分：** ☆☆☆☆☆

### 綜合評價
**問題記錄：**
1. _________________________________
2. _________________________________
3. _________________________________

**改進建議：**
1. _________________________________
2. _________________________________
3. _________________________________

**總體評分：** ☆☆☆☆☆ (滿分5星)
```

---

## ⚠️ 已知限制

1. **影像辨識依賴：**
   - 需要安裝 OpenCV (`pip install opencv-python`)
   - 模板匹配對光線和角度敏感

2. **視窗焦點：**
   - 某些遊戲需要視窗處於前景
   - 全螢幕遊戲可能無法辨識

3. **按鍵模擬：**
   - 部分遊戲有反外掛機制
   - 可能需要管理員權限

---

## 🎯 測試優先順序

### 高優先級（必須測試）
1. ✅ 合併視窗UI改進
2. ✅ 自動戰鬥視窗選擇功能
3. ⏳ 基礎腳本合併功能

### 中優先級（建議測試）
4. ⏳ 自動戰鬥視窗鎖定
5. ⏳ 日誌記錄功能
6. ⏳ 設定保存/載入

### 低優先級（時間允許時測試）
7. ⏳ 完整自動戰鬥流程
8. ⏳ 圖片辨識準確度
9. ⏳ 長時間運行穩定性

---

## 📝 測試檢查清單

- [x] UI 改進完成
- [x] 視窗選擇整合完成
- [ ] 合併功能測試
- [ ] 自動戰鬥基礎測試
- [ ] 圖片辨識測試
- [ ] 文檔整理完成

---

**測試負責人簽名：** _______________
**審核人簽名：** _______________

