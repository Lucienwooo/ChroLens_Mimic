# ChroLens_Mimic 使用說明

## 概述
ChroLens_Mimic 是一個功能強大的操作錄製與自動化工具，支援錄製滑鼠、鍵盤操作並可自動回放。

## 主要功能

### 1. 錄製與回放
- **開始錄製** (F10): 開始記錄滑鼠和鍵盤操作
- **暫停/繼續** (F11): 暫停或繼續錄製
- **停止** (F9): 停止錄製或回放
- **回放** (F12): 按照設定的速度和次數回放腳本

### 2. 腳本管理
- **腳本選單**: 快速選擇和載入已儲存的腳本
- **腳本重命名**: 重新命名腳本檔案（自動處理副檔名）
- **腳本列表**: 在「腳本設定」頁面查看所有腳本及其快捷鍵

### 3. 目標視窗選擇
- **選擇視窗**: 指定特定視窗進行操作錄製
- **視窗大小偵測**: 錄製時記錄視窗大小，回放時自動檢查並提示調整
- **視窗高亮**: 選定視窗後會以框線標示

### 4. 腳本編輯器（重新設計）
- **動作列表**: 使用表格方式管理腳本動作
- **視覺化編輯**: 每個動作以「指令-參數-延遲」格式呈現
- **動作管理**:
  - 新增動作: 選擇指令類型並設定參數
  - 編輯動作: 雙擊動作進行修改
  - 刪除動作: 選中動作後按 Delete 鍵
- **支援指令**:
  - `move_to(x, y)`: 移動滑鼠
  - `click()`: 左鍵點擊
  - `double_click()`: 雙擊
  - `right_click()`: 右鍵點擊
  - `type_text("文字")`: 輸入文字
  - `press_key("按鍵")`: 按下按鍵
  - `delay(毫秒)`: 延遲
  - `log("訊息")`: 輸出日誌

### 5. 快捷鍵系統
- **全域快捷鍵**: 在程式外也能觸發操作
- **腳本快捷鍵**: 為個別腳本設定專屬快捷鍵
- **自訂快捷鍵**: 在「整體設定」中修改預設快捷鍵

### 6. 回放設定
- **回放速度**: 1-1000 (100 = 正常速度 1x)
- **重複次數**: 設定執行幾次（0 = 無限循環）
- **重複時間**: 設定總執行時間
- **重複間隔**: 每次執行間的等待時間
- **隨機間隔**: 勾選後間隔時間會隨機化

### 7. MiniMode
- **精簡模式**: 縮小視窗只顯示核心按鈕
- **置頂顯示**: 視窗永遠在最上層
- **可拖曳**: 可自由移動位置
- **倒數計時**: 顯示剩餘執行時間

### 8. 多語言支援
支援三種語言介面：
- 繁體中文
- 日本語
- English

## 操作流程

### 基本錄製流程
1. （可選）點擊「選擇視窗」選定目標視窗
2. 點擊「開始錄製」或按 F10
3. 執行要錄製的操作
4. 點擊「停止」或按 F9
5. 腳本自動儲存到 scripts 資料夾

### 回放腳本
1. 在「腳本選單」選擇要執行的腳本
2. 調整回放速度、重複次數等參數
3. 點擊「回放」或按 F12
4. 系統會檢查視窗大小並提示是否需要調整

### 使用腳本編輯器
1. 點擊「腳本編輯器」按鈕
2. 點擊「新增動作」建立新動作
3. 選擇指令類型並輸入參數
4. 雙擊動作可進行編輯
5. 點擊「💾 儲存」儲存腳本
6. 點擊「▶ 執行」測試腳本

### 設定腳本快捷鍵
1. 切換到「腳本設定」頁面
2. 在左側列表選擇腳本
3. 在「捕捉快捷鍵」欄位輸入想要的按鍵組合
4. 點擊「設定快捷鍵」按鈕
5. 快捷鍵設定完成後，即可在程式外直接觸發

## 注意事項

### 視窗大小
- 錄製時會記錄目標視窗大小
- 回放時若視窗大小不同，會跳出提示
- 可選擇自動調整視窗大小或停止回放

### 檔案管理
- 所有腳本儲存在 `scripts` 資料夾
- 檔案格式為 JSON
- 下拉選單和列表中只顯示檔名（不含 .json）
- 重新命名時會自動處理副檔名

### 後台模式
- 程式使用智能後台模式
- 即使主視窗最小化，快捷鍵仍能正常運作
- 支援多種輸入法和按鍵組合

### 權限需求
- 程式需要監聽全域按鍵和滑鼠事件
- 部分防毒軟體可能會誤報
- 建議將程式加入白名單

## 快捷鍵一覽

### 預設快捷鍵
- F10: 開始錄製
- F11: 暫停/繼續
- F9: 停止
- F12: 回放
- Alt+`: 切換 MiniMode

### 腳本編輯器快捷鍵
- Delete: 刪除選中的動作
- 雙擊: 編輯動作

## 技術資訊

### 支援的按鍵
- 英文字母: a-z, A-Z
- 數字: 0-9
- 功能鍵: F1-F12
- 特殊鍵: Enter, Tab, Esc, Space, Backspace
- 組合鍵: Ctrl, Alt, Shift + 其他按鍵

### 支援的滑鼠操作
- 左鍵點擊
- 右鍵點擊
- 雙擊
- 滑鼠移動
- 滾輪滾動

### 檔案格式
```json
{
  "events": [...],
  "settings": {
    "script_actions": [...],
    "script_code": "...",
    "speed": 100,
    "repeat": 1,
    "window_size": [width, height],
    "script_hotkey": "..."
  }
}
```

## 常見問題

### Q: 快捷鍵不work?
A: 請確認：
1. 程式是否正在執行
2. 快捷鍵是否與其他程式衝突
3. 是否在「整體設定」中正確設定

### Q: 回放不準確?
A: 建議：
1. 使用「選擇視窗」功能限定目標視窗
2. 降低回放速度
3. 檢查視窗大小是否一致

### Q: 無法錄製某些操作?
A: 可能原因：
1. 目標程式使用特殊權限（如管理員權限）
2. 某些遊戲使用反作弊機制
3. 建議使用腳本編輯器手動建立動作

## 更新日誌

### v2.6 (2025-10-31)
- ✅ 重新設計腳本編輯器（參考 ChroLens_Sothoth）
- ✅ 使用動作列表方式管理腳本
- ✅ 新增視窗大小偵測功能
- ✅ 修復腳本下拉選單副檔名顯示問題
- ✅ 增加視窗選擇器寬度
- ✅ 腳本列表改用 Treeview 雙欄顯示
- ✅ 還原 MiniMode 為 TinyMode 風格
- ✅ 完善多語言支援

### 已知問題
- 無

## 授權與支援
- 作者: Lucienwooo
- 專案: ChroLens_Mimic
- 版本: 2.6
