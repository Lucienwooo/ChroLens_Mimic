# 版本2：標準版（功能完整）

## 📖 ChroLens 文字指令參考手冊

### 指令結構
每個指令由三部分組成：
```
>動作內容, 延遲時間, T=執行時間點
```

---

## 🎯 支援的動作類型

### ⌨️ 鍵盤操作

#### 可用動作
1. **按鍵**：按下後立即放開
2. **按下**：只按下不放開（用於組合鍵）
3. **放開**：放開已按下的按鍵

#### 支援的按鍵
- 字母：A-Z
- 數字：0-9
- 功能鍵：F1-F12
- 特殊鍵：Enter, Space, Tab, Escape, Backspace
- 修飾鍵：Ctrl, Shift, Alt, Win
- 方向鍵：Up, Down, Left, Right

---

### 🖱️ 滑鼠操作

#### 可用動作
1. **移動至**：移動滑鼠到指定座標
2. **左鍵點擊**：在指定位置點擊左鍵
3. **右鍵點擊**：在指定位置點擊右鍵
4. **中鍵點擊**：在指定位置點擊中鍵
5. **雙擊**：快速點擊兩次
6. **按下left鍵**：按住左鍵不放（拖曳起點）
7. **放開left鍵**：放開左鍵（拖曳終點）

#### 座標格式
- 絕對座標：`(X,Y)` 例如 `(1920,1080)`
- 螢幕左上角為 `(0,0)`

---

### 🖼️ 圖片辨識操作

#### 可用動作
1. **辨識**：找到圖片位置（不移動滑鼠）
2. **移動至**：移動滑鼠到圖片中心
3. **左鍵點擊**：點擊圖片（點擊後滑鼠回到原位）
4. **右鍵點擊**：右鍵點擊圖片
5. **辨識任一**：同時找多張圖片（找到任何一張即可）

#### 圖片命名規則
- 使用 `pic` + 數字：pic01, pic02, pic03...
- 截圖時自動命名
- 支援 pic01 到 pic999

---

### 🔀 條件判斷

#### 可用動作
1. **if判斷**：檢查圖片是否存在
2. **成功分支**：用 `>>` 開頭，圖片存在時執行
3. **失敗分支**：用 `>>>` 開頭，圖片不存在時執行

#### 分支動作
- **跳轉**：`>>#標籤名` 或 `>>跳到#標籤名`
- **繼續**：不寫任何內容（留空）

---

### 🏷️ 標籤與跳轉

#### 可用動作
1. **定義標籤**：`#標籤名稱`
2. **跳轉**：`>跳到#標籤名稱`
3. **條件跳轉**：在 if 判斷中使用 `>>#標籤名`

#### 標籤規則
- 標籤名稱可用中文、英文、數字
- 不可重複定義
- 建議使用有意義的名稱

---

## 📝 完整範例

### 範例1：自動輸入文字
```
# 在文字欄位輸入帳號密碼

>左鍵點擊(500,300), T=0s000       # 點擊帳號欄位
>按u, 延遲50ms, T=0s100
>按s, 延遲50ms, T=0s150
>按e, 延遲50ms, T=0s200
>按r, 延遲50ms, T=0s250
>按Tab, 延遲50ms, T=0s300          # 跳到下一欄
>按1, 延遲50ms, T=0s400
>按2, 延遲50ms, T=0s450
>按3, 延遲50ms, T=0s500
>按4, 延遲50ms, T=0s550
>按Enter, 延遲50ms, T=0s600        # 送出
```

### 範例2：組合鍵操作
```
# 複製、切換視窗、貼上

# Ctrl+C 複製
>按下Ctrl, 延遲0ms, T=0s000
>按C, 延遲100ms, T=0s000
>放開Ctrl, 延遲0ms, T=0s100

# Alt+Tab 切換視窗
>按下Alt, 延遲0ms, T=0s500
>按Tab, 延遲100ms, T=0s500
>放開Alt, 延遲0ms, T=0s600

# Ctrl+V 貼上
>按下Ctrl, 延遲0ms, T=1s000
>按V, 延遲100ms, T=1s000
>放開Ctrl, 延遲0ms, T=1s100
```

### 範例3：拖曳操作
```
# 從 (100,100) 拖曳到 (500,500)

>移動至(100,100), T=0s000
>按下left鍵(100,100), T=0s100      # 按住不放
>移動至(500,500), T=0s500          # 拖曳過程
>放開left鍵(500,500), T=0s600      # 放開完成
```

### 範例4：圖片辨識與點擊
```
# 找到按鈕並點擊

>辨識>pic01, T=0s000               # 先確認圖片存在
>移動至>pic01, T=0s100             # 移動到圖片位置
>左鍵點擊>pic01, T=0s200           # 點擊（會自動回原位）
```

### 範例5：條件判斷與分支
```
# 如果看到確認按鈕就點擊，否則取消

>if>pic01, T=0s000
>>#確認存在
>>>#取消操作

#確認存在
>左鍵點擊>pic01, T=0s500
>跳到#完成, T=1s000

#取消操作
>按Escape, 延遲50ms, T=1s500

#完成
```

### 範例6：循環等待
```
# 一直等待直到按鈕出現

#等待
>if>pic01, T=0s000
>>#找到了
>>>#等待

#找到了
>左鍵點擊>pic01, T=0s500
```

### 範例7：多圖辨識
```
# 找到任何一個按鈕就點擊

>辨識任一>pic01|pic02|pic03, T=0s000
>左鍵點擊>pic01|pic02|pic03, T=0s500
```

### 範例8：遊戲連續技能
```
# 按順序施放技能 1→2→3→4

#技能循環
>按1, 延遲100ms, T=0s000
>按2, 延遲100ms, T=0s500
>按3, 延遲100ms, T=1s000
>按4, 延遲100ms, T=1s500
>跳到#技能循環, T=2s000
```

---

## ⏱️ 時間參數說明

### 延遲時間（delay）
- 格式：`延遲Xms`
- 表示按鍵按住的時間
- 建議值：
  - 快速點擊：30-50ms
  - 正常輸入：50-100ms
  - 長按動作：100-500ms

### 絕對時間（T=）
- 格式：`T=秒數s毫秒`
- 表示從腳本開始的累計時間
- 範例：
  - `T=0s000` = 0 秒
  - `T=0s100` = 0.1 秒（100毫秒）
  - `T=1s500` = 1.5 秒
  - `T=17s000` = 17 秒

### 時間規則
1. 絕對時間必須遞增（不能倒退）
2. 相同時間可以有多個動作（組合鍵）
3. 建議每個動作間隔至少 50-100ms

---

## 🎨 圖片辨識設定

### 截圖方式
1. 點擊編輯器的「📷 圖片辨識」按鈕
2. 拖曳選取要辨識的區域
3. 自動儲存並命名為 pic01, pic02...

### 圖片檔案位置
- 儲存路徑：`scripts/images/`
- 檔名格式：`pic01.png`, `pic02.png`...

### 辨識建議
- 截取包含背景的圖片（增加辨識準確度）
- 避免截取純色區域
- 圖片大小建議：50x50 到 200x200 像素
- 確保目標與背景有明顯對比

---

## 🔧 進階技巧

### 1. 重複動作
使用標籤和跳轉實現循環：
```
#開始
>按Space, 延遲50ms, T=0s000
>跳到#開始, T=0s100
```

### 2. 條件嵌套
實現 AND 邏輯：
```
>if>pic01, T=0s000
>>#檢查第二個
>>>#失敗

#檢查第二個
>if>pic02, T=0s100
>>#兩個都有
>>>#失敗

#兩個都有
>左鍵點擊(100,100), T=0s200

#失敗
```

### 3. 重試機制
```
#嘗試1
>if>pic01, T=0s000
>>#成功
>>>#嘗試2

#嘗試2
>if>pic01, T=1s000
>>#成功
>>>#嘗試3

#嘗試3
>if>pic01, T=2s000
>>#成功
>>>#放棄

#成功
>左鍵點擊>pic01, T=3s000

#放棄
>按Escape, 延遲50ms, T=4s000
```

---

## 📌 注意事項

### ✅ 可以做的
- 固定流程的自動化
- 圖片辨識操作
- 簡單的條件判斷
- 循環重複動作

### ❌ 無法做的
- 變數計算（無法儲存數值）
- 複雜邏輯（AND/OR 需要嵌套）
- 動態座標（無法計算偏移）
- 文字辨識（需要圖片辨識）
- 讀寫檔案

### 💡 替代方案
- 變數 → 使用標籤模擬狀態
- AND/OR → 使用嵌套條件
- 動態座標 → 使用圖片辨識
- 迴圈 → 手動展開或使用跳轉

---

## 🎓 學習建議

1. **從簡單開始**：先練習單一動作
2. **逐步組合**：加入條件判斷
3. **加入循環**：使用標籤跳轉
4. **建立模組**：儲存常用指令
5. **測試調整**：逐步優化時間

---

## 💾 快捷操作

- **儲存模組**：反白文字 → 右鍵 → 儲存為自訂模組
- **載入模組**：右鍵 → 插入自訂模組
- **快速複製**：複製整段指令並修改參數
- **時間調整**：直接修改 T= 後面的數值
