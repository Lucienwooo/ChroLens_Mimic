# ChroLens Mimic

> **版本:** 2.6.5  
> **專案類型:** Windows 自動化工具  
> **開發者:** Lucienwooo (ChroLens Studio)

一款功能強大的 Windows 錄製與回放工具,支援文字指令編輯、圖片辨識、條件判斷等進階功能。

---

## 📚 文檔導覽

### 使用者文檔
- **[指令說明.md](指令說明.md)** - 完整的文字指令使用手冊
- **[標籤使用範例.md](標籤使用範例.md)** - 標籤與跳轉語法範例與常見問題

### 開發文檔
- **[CHANGELOG.md](CHANGELOG.md)** - 開發變更日誌(所有更新記錄)
- **[重構計畫.md](重構計畫.md)** + **[重構完成報告.md](重構完成報告.md)** - 專案重構記錄
- **[修復說明_編輯器問題.md](修復說明_編輯器問題.md)** - 編輯器重大修復記錄
- **[強化與整理完成報告.md](強化與整理完成報告.md)** - 圖片辨識強化總結

---

## ✨ 核心功能

### 1. 錄製與回放
- 🎯 精確錄製鍵盤、滑鼠操作
- ⚡ 可調速度回放(1-1000%)
- 🔄 支援重複執行(次數/時間控制)
- ⏱️ 隨機間隔防偵測

### 2. 文字指令編輯器
- 📝 可視化文字格式編輯腳本
- 🔍 支援圖片辨識指令
- 🏷️ 標籤與條件跳轉
- 💾 雙向轉換(JSON ↔ 文字)

### 3. 圖片辨識(強化版)
- 🎨 多算法融合匹配(TM_CCOEFF + TM_CCORR + TM_SQDIFF)
- 🔬 SSIM 結構相似度驗證
- 📊 直方圖顏色比對
- 🖼️ Canny 邊緣檢測
- 🎯 預設閾值 0.92(近乎完美匹配)
- 📐 多尺度搜尋(80%-120%)

### 4. 條件判斷
- ✅ if/else 分支執行
- 🔁 標籤跳轉與循環
- 🛑 停止/繼續控制

### 5. 視窗管理
- 🎯 目標視窗選擇
- 📺 多顯示器支援
- 🖱️ 相對座標/絕對座標

---

## 🚀 快速開始

### 基本錄製
1. 點擊「開始錄製」(F10)
2. 執行想要自動化的操作
3. 點擊「停止」(F9)
4. 點擊「回放」(F12)測試

### 使用文字編輯器
1. 選擇腳本 → 點擊「開啟編輯器」
2. 使用文字指令編輯(參考 [指令說明.md](指令說明.md))
3. 儲存並關閉
4. 選擇腳本並回放

### 圖片辨識範例
```
# 尋找並點擊目標
>if>target, T=0s000
>>#成功
>>>#重試

#成功
>左鍵點擊>target, T=0s100

#重試
# 回到開始重新尋找
```

詳細說明請參考 [標籤使用範例.md](標籤使用範例.md)

---

## ⚙️ 系統需求

- **作業系統:** Windows 10/11
- **Python:** 3.8+ (開發環境)
- **權限:** 建議以管理員身份執行
- **依賴套件:**
  - opencv-python >= 4.5.0
  - Pillow >= 8.0.0
  - numpy >= 1.19.0
  - scikit-image >= 0.18.0 (選用,SSIM驗證)
  - ttkbootstrap
  - keyboard
  - pywin32

---

## 🛠️ 開發維護

### 清理測試檔案
```bash
python cleanup_test_files.py
```

### 打包執行檔
```bash
python build_simple.py
```

### 檔案結構
```
main/
├── ChroLens_Mimic.py       # 主程式
├── recorder.py             # 核心錄製引擎
├── text_script_editor.py   # 文字指令編輯器
├── script_io.py            # 腳本 I/O 工具
├── lang.py                 # 多語言支援
├── mini.py                 # Mini 模式
├── cleanup_test_files.py   # 清理工具
├── README.md               # 本檔案
├── CHANGELOG.md            # 變更日誌
├── 指令說明.md             # 使用手冊
└── 標籤使用範例.md         # 標籤範例
```

---

## 📝 常見問題

### Q: 標籤跳轉不正常?
A: 確保標籤已定義。`>>#點擊` 需要對應的 `#點擊` 標籤定義,否則會被視為繼續執行。詳見 [標籤使用範例.md](標籤使用範例.md)

### Q: 圖片辨識失敗?
A: 
1. 確保圖片在相同解析度下擷取
2. 預設閾值 0.92 很嚴格,可調整 confidence 參數(0.85-0.88)
3. 查看日誌中的匹配度分數

### Q: 快捷鍵無效?
A: 以管理員身份執行程式

### Q: 如何停止無限循環?
A: 使用強制退出快捷鍵 Ctrl+Alt+Z

---

## 🔄 更新日誌

查看 [CHANGELOG.md](CHANGELOG.md) 了解詳細的更新記錄。

### 最新更新 (2.6.5+)
- ✅ 圖片辨識閾值提升至 0.92
- ✅ 標籤功能完整支援
- ✅ 文檔整合與清理
- ✅ 測試檔案自動清理工具

---

## 📞 技術支援

**專案維護:** Lucienwooo  
**組織:** ChroLens Studio

如遇問題請提供:
1. 問題描述(預期 vs 實際)
2. 重現步驟
3. 錯誤訊息或截圖
4. 相關腳本內容

---

## 📜 授權

本專案為個人開發專案,請勿用於商業用途。

---

**最後更新:** 2025-01-12
